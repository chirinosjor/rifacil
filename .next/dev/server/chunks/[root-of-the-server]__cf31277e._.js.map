{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///Users/jorge.chirinos/Documents/Jorge/rifacil/lib/supabase/server.ts"],"sourcesContent":["import { createServerClient } from \"@supabase/ssr\";\nimport { cookies } from \"next/headers\";\n\nexport async function createServerSupabaseClient() {\n  const cookieStore = await cookies();\n\n  return createServerClient(\n    process.env.NEXT_PUBLIC_SUPABASE_URL!,\n    process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!,\n    {\n      cookies: {\n        getAll() {\n          return cookieStore.getAll();\n        },\n        setAll(cookiesToSet) {\n          try {\n            cookiesToSet.forEach(({ name, value, options }) =>\n              cookieStore.set(name, value, options)\n            );\n          } catch {\n            // Handle cookie setting errors\n          }\n        },\n      },\n    }\n  );\n}\n"],"names":[],"mappings":";;;;AAAA;AAAA;AACA;;;AAEO,eAAe;IACpB,MAAM,cAAc,MAAM,IAAA,2QAAO;IAEjC,OAAO,IAAA,8SAAkB,sUAGvB;QACE,SAAS;YACP;gBACE,OAAO,YAAY,MAAM;YAC3B;YACA,QAAO,YAAY;gBACjB,IAAI;oBACF,aAAa,OAAO,CAAC,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE,OAAO,EAAE,GAC5C,YAAY,GAAG,CAAC,MAAM,OAAO;gBAEjC,EAAE,OAAM;gBACN,+BAA+B;gBACjC;YACF;QACF;IACF;AAEJ"}},
    {"offset": {"line": 76, "column": 0}, "map": {"version":3,"sources":["file:///Users/jorge.chirinos/Documents/Jorge/rifacil/app/api/games/route.ts"],"sourcesContent":["import { NextResponse } from \"next/server\";\nimport { createServerSupabaseClient } from \"@/lib/supabase/server\";\n\nexport async function POST(req: Request) {\n  try {\n    // Create Supabase client (reads cookies from request)\n    const supabase = await createServerSupabaseClient();\n\n    // Check authenticated user\n    const {\n      data: { user },\n      error: userError,\n    } = await supabase.auth.getUser();\n\n    if (userError || !user) {\n      return NextResponse.json({ error: \"Unauthorized\" }, { status: 401 });\n    }\n\n    // Parse request body\n    const { name, total_numbers, ticket_price } = await req.json();\n\n    if (!name || !total_numbers || !ticket_price) {\n      return NextResponse.json(\n        { error: \"Missing required fields\" },\n        { status: 400 }\n      );\n    }\n\n    // Create game\n    const { data: game, error: gameError } = await supabase\n      .from(\"games\")\n      .insert({\n        user_id: user.id,\n        name,\n        total_numbers: Number(total_numbers),\n        ticket_price: Number(ticket_price),\n      })\n      .select()\n      .single();\n\n    if (gameError) {\n      return NextResponse.json({ error: gameError.message }, { status: 400 });\n    }\n\n    // Pre-create all tickets\n    const tickets = Array.from({ length: Number(total_numbers) }, (_, i) => ({\n      game_id: game.id,\n      ticket_number: i + 1,\n      is_paid: false,\n    }));\n\n    const { error: ticketsError } = await supabase\n      .from(\"tickets\")\n      .insert(tickets);\n\n    if (ticketsError) {\n      return NextResponse.json(\n        { error: ticketsError.message },\n        { status: 400 }\n      );\n    }\n\n    return NextResponse.json(game);\n  } catch (err) {\n    console.error(\"API Error:\", err);\n    return NextResponse.json(\n      { error: \"Internal server error\" },\n      { status: 500 }\n    );\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,eAAe,KAAK,GAAY;IACrC,IAAI;QACF,sDAAsD;QACtD,MAAM,WAAW,MAAM,IAAA,yJAA0B;QAEjD,2BAA2B;QAC3B,MAAM,EACJ,MAAM,EAAE,IAAI,EAAE,EACd,OAAO,SAAS,EACjB,GAAG,MAAM,SAAS,IAAI,CAAC,OAAO;QAE/B,IAAI,aAAa,CAAC,MAAM;YACtB,OAAO,+QAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAe,GAAG;gBAAE,QAAQ;YAAI;QACpE;QAEA,qBAAqB;QACrB,MAAM,EAAE,IAAI,EAAE,aAAa,EAAE,YAAY,EAAE,GAAG,MAAM,IAAI,IAAI;QAE5D,IAAI,CAAC,QAAQ,CAAC,iBAAiB,CAAC,cAAc;YAC5C,OAAO,+QAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAA0B,GACnC;gBAAE,QAAQ;YAAI;QAElB;QAEA,cAAc;QACd,MAAM,EAAE,MAAM,IAAI,EAAE,OAAO,SAAS,EAAE,GAAG,MAAM,SAC5C,IAAI,CAAC,SACL,MAAM,CAAC;YACN,SAAS,KAAK,EAAE;YAChB;YACA,eAAe,OAAO;YACtB,cAAc,OAAO;QACvB,GACC,MAAM,GACN,MAAM;QAET,IAAI,WAAW;YACb,OAAO,+QAAY,CAAC,IAAI,CAAC;gBAAE,OAAO,UAAU,OAAO;YAAC,GAAG;gBAAE,QAAQ;YAAI;QACvE;QAEA,yBAAyB;QACzB,MAAM,UAAU,MAAM,IAAI,CAAC;YAAE,QAAQ,OAAO;QAAe,GAAG,CAAC,GAAG,IAAM,CAAC;gBACvE,SAAS,KAAK,EAAE;gBAChB,eAAe,IAAI;gBACnB,SAAS;YACX,CAAC;QAED,MAAM,EAAE,OAAO,YAAY,EAAE,GAAG,MAAM,SACnC,IAAI,CAAC,WACL,MAAM,CAAC;QAEV,IAAI,cAAc;YAChB,OAAO,+QAAY,CAAC,IAAI,CACtB;gBAAE,OAAO,aAAa,OAAO;YAAC,GAC9B;gBAAE,QAAQ;YAAI;QAElB;QAEA,OAAO,+QAAY,CAAC,IAAI,CAAC;IAC3B,EAAE,OAAO,KAAK;QACZ,QAAQ,KAAK,CAAC,cAAc;QAC5B,OAAO,+QAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAAwB,GACjC;YAAE,QAAQ;QAAI;IAElB;AACF"}}]
}